package com.api.digital.security.service;

import org.springframework.stereotype.Service;

import com.api.digital.security.dto.VulnerabilityDataTransferObject;
import com.api.digital.security.exceptions.IdNotFoudException;
import com.api.digital.security.model.Vulnerabilities;
import com.api.digital.security.repository.VulnerabilitiesRepository;

@Service
public class VulnerabilityService {
	
	private final VulnerabilitiesRepository vulnerabilitiesRepository;
	private final VulnerabilityMapper vulnerabilityMapper;
	
	
	public VulnerabilityService(VulnerabilitiesRepository vulnerabilitiesRepository,
			VulnerabilityMapper vulnerabilityMapper) {
		this.vulnerabilitiesRepository = vulnerabilitiesRepository;
		this.vulnerabilityMapper = vulnerabilityMapper;
	}



	public VulnerabilityDataTransferObject findByVulnerabilityId(Long id) {
		
		Vulnerabilities vulnerabilities = vulnerabilitiesRepository.findById(id)
				.orElseThrow(() -> new IdNotFoudException("Vulnerabilidade com ID: " + id + " n√£o encontrado."));
		
		return vulnerabilityMapper.convertToDTO(vulnerabilities);
	}

}
